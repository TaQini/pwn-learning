b _fini
find 0x804861c
x/xw 0x804861c
x/xw 0x8048f3c
x/xw 0x8049f3c
q
b main 
r AA
x/xw 0x8049f14
b __do_global_ctors_aux
c
q
b main 
r `python a.py `
disassemble 
b *0x08048569
c
ni
r `python a.py `
c
ni
r `python a.py `
c
ni
q
b *0x08048569
r `python a.py `
r `python a.py `
ni
r `python a.py `
ni
r `python a.py `
ni
r `python a.py `
ni
r `python a.py `
ni
si
si
print print hex(tmp)
print $ebx+0x5d5b04c4
si
print $ebx+0x5d5b04c4
x/xw $2
r `python a.py `
ni
x/xw $ebx+$esi*4-0xe0
ni
r `python a.py `
ni
r `python a.py `
n
ni
stack 15
ni
r `python a.py `
ni
si
r `python a.py `
ni
si
ni
si
ni
x/xw g3
x/xw 0x804a028
ni
q
b main 
r
r `python a.py `
disassemble 
b *0x080483b0
c
c
c
b *0x080483b0
r `python a.py `
c
c
c
r `python a.py `
c
ni
q
b main 
r `python a.py`
ni
disassemble 
b *0x08048569
c
ni
n 20
ni
ni
find /bin
find /bin/sh
x/10xw 0x804a028
ni
r `python a.py`
print system
b *0xf7e46310
c
c
ni
print execve 
print getuid
q
b main 
r `python a.py`
disa
disassemble 
b *0x08048569
c
b execve 
c
r `python a.py`
c
ni
ni
q
b main 
r `python a.py `
print execve 
print getuid
r `python a.py `
c
r `python a.py `
c
r `python a.py `
disassemble s
disassemble 
b *0x08048569
c
r `python a.py `
c
ni
x/10xw 0x804a028
ni
r `python a.py `
c
ni
x/10xw 0x804a028
ni
x/xw 0x08048569
x/xw 0x804a004
print execve
r `python a.py `
c
c
r `python a.py `
c
ni
b getuid@plt
c
ni
r `python a.py `
c
c
c
ni
c
r `python a.py `
c
c
c
ni
r `python a.py `
c
c
c
ni
r `python a.py `
c
c
r `python a.py `
c
c
ni
c
r `python a.py `
c
c
c
disassemble 
disassemble main 
r `python a.py `
c
c
c
ni
c
r `python a.py `
c
c
c
disassemble 
disassemble main
b *0x080484e1
r `python a.py `
c
c
c
c
r AAA
ni
fini
c
ni
r `python a.py `
r `python a.py `
c
c
c
c
c
c
c
r `python a.py `
c
c
c
c
c
c
r AAAA
ni
fini
fini
ni
q
b main 
r `python a.py`
disassemble 
b execve 
c
c
q
b main 
r
b execve
r
c
q
b execve
b main 
r `python a.py`
b execve
c
q
b main 
r `python a.py`
b execve
c
ni
c
